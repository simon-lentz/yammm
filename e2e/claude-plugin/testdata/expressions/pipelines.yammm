schema "expr_pipelines"

// Source: expressions.md, "Pipeline Operator" and "Lambda Syntax" sections

type PipeRecord {
    id String primary
    name String[1, 100] required
    csv String
    price Float[0.0, _] required
    quantity Integer[1, _] required

    // Simple pipeline
    ! "name_upper_nonempty" name -> Upper -> Len > 0

    // Pipeline with arguments
    ! "name_trimmed" name -> Trim -> Len <= name -> Len

    // Pipeline with lambda
    ! "csv_items_check" csv == nil || csv -> Split(",") -> All |$x| { $x -> Len > 0 }

    // Reduce
    ! "positive_total" [price, price] -> Reduce(0.0) |$acc, $p| { $acc + $p } > 0.0
}
